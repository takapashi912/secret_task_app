
  <% @tasks.each do |task| %>
    <div class="p-4 flex items-center gap-4 bg-gray-50 rounded-xl shadow divide-y mx-10 my-2">
      <div class="flex-1">
        <div class="font-medium"><%= task.title %></div>
        <div class="text-sm text-gray-600">
          期限: <%= l(task.due_at, format: :long) rescue task.due_at %>
          <br>
          <% if task.question_template_id.present? %>
            ・テンプレの質問: <%= task.question_template&.body %>
            <br>
          <% end %>
          <% if task.secret_post.present? %>
            ・公開される秘密: <%= task.secret_post.content %>
          <% end %>
        </div>
        <div class="p-4 flex items-center gap-4">
          <div class="flex-1"></div>
          <% if task&.pending? %>
            <%= button_to "達成にする", complete_task_path(task),
              method: :patch,
              class: "px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700" %>
            <%= button_to "未達成にする", not_complete_task_path(task),
              method: :patch,
              onclick: "return confirm('本当に未達成として扱いますか？');",
              class: "px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700" %>
          <% elsif task&.completed? %>
            <span class="text-green-700 text-sm font-semibold">このタスクは達成済みです。</span>
          <% elsif task&.not_completed? %>
            <span class="text-red-700 text-sm font-semibold">このタスクは未達成です。</span>
          <% end %>
          <%= link_to "詳細", task_path(task), class: "px-3 py-2 bg-indigo-600 rounded text-white hover:bg-indigo-700" %>
          <%= link_to "編集", edit_task_path(task), class: "px-3 py-2 bg-gray-600 rounded text-white hover:bg-gray-700" %>
          <%= button_to "削除", task_path(task),
            method: :delete,
            onclick: "return confirm('本当に削除しますか？');",
            class: "px-3 py-2 bg-red-600 text-white rounded hover:bg-red-700" %>
        </div>
      </div>

      <span class="text-xs px-2 py-1 rounded
        <%= case task.status
             when "pending" then "bg-yellow-100 text-yellow-800"
             when "completed" then "bg-green-100 text-green-800"
             else "bg-red-100 text-red-800"
           end %>">
        <%= task.status %>
      </span>
    </div>
  <% end %>

  <% if @tasks.blank? %>
    <div class="p-6 text-gray-500 bg-gray-50 rounded-xl shadow divide-y mx-10 my-2">まだタスクがありません。</div>
  <% end %>

